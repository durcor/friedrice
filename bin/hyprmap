#!/bin/sh

. ~/.cache/wal/colors.sh

submap_name=$1

[ $submap_name ] || {
    echo "Error: No submap name provided"
    exit 1
}

case $submap_name in
    toggle)
        cur_submap=$(hyprctl submap)
        case $cur_submap in
            window)
                toggled_submap=manager
                ;;
            manager)
                toggled_submap=window
                ;;
        esac
        submap_name=$toggled_submap
        ;;
esac

cur_win=$(hyprctl -j activewindow | jq -r .address)

# hyprctl --batch "setprop address:$cur_win bordersize 20; submap $submap_name" \
#     && sleep 0.2 && hyprctl dispatch setprop address:$cur_win bordersize 4

# hyprctl dispatch setprop address:$cur_win bordersize 20 \
#     && hyprctl dispatch submap $submap_name && sleep 0.2 \
#     && hyprctl dispatch setprop address:$cur_win bordersize 4

normal_color=$(hyprctl getoption general:col.active_border | awk -F: 'NR == 1 {print $2}')

case $(echo $normal_color | wc -w) in
    3)
        set_color=$(echo $normal_color | awk '{printf "rgba(%s) rgba(%s)", $1, $2}')
        gradient_angle=$(echo $normal_color | awk '{print $3}')
        ;;
    2)
        set_color=$(echo $normal_color | awk '{printf "rgba(%s)", $1}')
        gradient_angle=$(echo $normal_color | awk '{print $2}')
        ;;
    *) ;;
esac

hyprctl keyword general:col.active_border "rgb($(echo $color12 | sed 's/#//'))" \
    && hyprctl dispatch submap $submap_name \
    && sleep 0.2 \
    && hyprctl keyword general:col.active_border $set_color $gradient_angle
