#!/bin/sh

case $BLOCK_BUTTON in
    1)
        notify-send \
            -h string:x-canonical-private-synchronous:i3bcpu \
            "Info for $(neofetch cpu)" "$(sensors | grep -B3 -A3 die)"
                    ;;
	3)
        notify-send \
            -h string:x-canonical-private-synchronous:i3bcpu \
            "CPU hogs" "$(ps axch -o cmd:15,%cpu --sort=-%cpu | head)"
                    ;;
esac

usage=$(echo "$(ps aux | awk 'BEGIN {sum=0} {sum+=$3}; END {print sum}')/$(nproc)" | bc)

cpu_icon=""

# if [ "$usage" -ge 90 ]; then
#     icon=""
# elif [ "$usage" -ge 60 ]; then
#     icon=""
# elif [ "$usage" -ge 40 ]; then
#     icon=""
# elif [ "$usage" -ge 10 ]; then
#     icon=""
# else
#     icon=""
# fi

command=$(sensors | awk '/die/ {print $2}')

echo "$cpu_icon  ${usage}% ${command}°C"
